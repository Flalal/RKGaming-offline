import {_ as b, u as E, a as S, s as p, b as L, w as I, o as K, c as F, d as R, e as s, f as r, n as z, g as w, t as D, h as f, i as Y, j as G, k as $, l as t, H as i} from "./index-C3DhiZUV.js";
import {V as H, _ as N, a as V} from "./VBtn-RiwyMaVp.js";
const O = {
    class: "mainBox"
}
  , j = {
    class: "connectBox"
}
  , A = {
    class: "connectBtnBox"
}
  , T = {
    class: "content-container"
}
  , q = {
    class: "title"
}
  , W = {
    class: "btn-content"
}
  , J = {
    style: {
        width: "200px",
        display: "flex",
        "justify-content": "center",
        "align-items": "center",
        "margin-top": "15px"
    }
}
  , Q = {
    class: "ConnectPageFoot"
}
  , U = {
    class: "brand-text"
}
  , X = {
    __name: "ConnectDrivePage",
    setup(Z) {
        function e(l) {
            return new Promise(o => {
                setTimeout(o, l)
            }
            )
        }
        const a = G("WebHIDService")
          , g = $()
          , C = E()
          , _ = S()
          , {KeyboardConnectStatus: n, KeyboardRunMode: u, routerPage: m, customerBranch: d} = p(C)
          , {staticLightColorList: v, LogoRGBStaticLightColorList: x} = p(_)
          , {locale: c} = L()
          , k = l => {
            t.log(1, `切换页面语言：${l}`),
            c.value = l
        }
          , B = async () => {
            try {
                await a.requestDevice()
            } catch (l) {
                t.log(3, `Failed to request device:${l}`);
                return
            }
            try {
                await a.openDevice()
            } catch (l) {
                t.log(3, `Failed to open device:${l}`);
                return
            }
            await a.startEventListen(),
            t.log(0, "开始获取键盘基本信息..."),
            n.value = 2,
            await a.writeData(i.SYNCPack()),
            await e(200),
            u.value === 255 ? (t.log(0, "当前键盘处于Boot模式，初始化结束..."),
            n.value = 3) : (t.log(0, "当前键盘处于App模式，即将开始初始化键盘数据..."),
            t.log(0, "获取键盘名称..."),
            await a.writeData(i.CMDPack(1, null)),
            await e(2),
            await a.writeData(i.CMDPack(38, null)),
            await e(2),
            t.log(0, "获取键盘精度及最大最小行程..."),
            await a.writeData(i.CMDPack(37, null)),
            await e(2),
            t.log(0, "获取键盘配置ID..."),
            await a.writeData(i.CMDPack(112, 4)),
            await e(2),
            t.log(0, "获取键盘支持的轴体ID..."),
            await a.writeData(i.CMDPack(118, null)),
            await e(2),
            t.log(0, "获取键盘回报率..."),
            await a.writeData(i.CMDPack(80, 7)),
            await e(2),
            t.log(0, "查询键盘win模式..."),
            await a.writeData(i.CMDPack(33, null)),
            await e(2),
            t.log(0, "查询键盘mac模式..."),
            await a.writeData(i.CMDPack(34, null)),
            await e(2),
            t.log(0, "获取顶部死区开关状态..."),
            await a.writeData(i.CMDPack(52, 2)),
            await e(2),
            t.log(0, "获取键盘全局行程和死区..."),
            await a.writeData(i.DBPack(0, 0, 0, 0)),
            await e(2),
            t.log(0, "获取键盘灯光偏色设置..."),
            await a.writeData(i.CMDArrayPack(68, [255, 255, 255])),
            await e(2),
            t.log(0, "获取键盘灯光设置..."),
            await a.writeData(i.PRGBPack(0, v.value, !1, !1, !1, 0, 0, 0, 0)),
            await e(50),
            t.log(0, "获取键盘氛围灯光设置..."),
            await a.writeData(i.LOGORGBPack(0, x.value, !1, !1, !1, 0, 0, 0, 0, 0)),
            await e(50),
            t.log(0, "获取键盘HID矩阵..."),
            await a.writeData(i.DEFKEYPack(0, 1)),
            await e(2),
            await a.writeData(i.DEFKEYPack(2, 3)),
            await e(2),
            await a.writeData(i.DEFKEYPack(4, 5)),
            await e(2)),
            t.log(0, "即将跳转至驱动页面..."),
            await e(800),
            g.push({
                path: "/device"
            })
        }
        ;
        I(n, async () => {
            n.value === 1 && m.value === 0 && (t.log(0, "键盘连接状态改变，开始获取键盘基本信息..."),
            n.value = 2,
            await a.writeData(i.SYNCPack()),
            await e(200),
            u.value === 255 ? (t.log(0, "当前键盘处于Boot模式，初始化结束..."),
            n.value = 3) : (t.log(0, "当前键盘处于App模式，即将开始初始化键盘数据..."),
            await a.writeData(i.CMDPack(1, null)),
            await e(2),
            t.log(0, "获取键盘名称..."),
            await a.writeData(i.CMDPack(38, null)),
            await e(2),
            t.log(0, "获取键盘精度及最大最小行程..."),
            await a.writeData(i.CMDPack(37, null)),
            await e(2),
            t.log(0, "获取键盘配置ID..."),
            await a.writeData(i.CMDPack(112, 4)),
            await e(2),
            t.log(0, "获取键盘轴体ID..."),
            await a.writeData(i.CMDPack(118, null)),
            await e(2),
            t.log(0, "获取键盘回报率..."),
            await a.writeData(i.CMDPack(80, 7)),
            await e(2),
            t.log(0, "查询键盘win模式..."),
            await a.writeData(i.CMDPack(33, null)),
            await e(2),
            t.log(0, "查询键盘mac模式..."),
            await a.writeData(i.CMDPack(34, null)),
            await e(2),
            t.log(0, "获取顶部死区开关状态..."),
            await a.writeData(i.CMDPack(52, 2)),
            await e(2),
            t.log(0, "获取键盘全局行程和死区..."),
            await a.writeData(i.DBPack(0, 0, 0, 0)),
            await e(2),
            t.log(0, "获取键盘灯光设置..."),
            await a.writeData(i.PRGBPack(0, v.value, !1, !1, !1, 0, 0, 0, 0)),
            await e(50),
            t.log(0, "获取键盘氛围灯光设置..."),
            await a.writeData(i.LOGORGBPack(0, x.value, !1, !1, !1, 0, 0, 0, 0, 0)),
            await e(50),
            t.log(0, "获取键盘HID矩阵..."),
            await a.writeData(i.DEFKEYPack(0, 1)),
            await e(2),
            await a.writeData(i.DEFKEYPack(2, 3)),
            await e(2),
            await a.writeData(i.DEFKEYPack(4, 5)),
            await e(2)),
            g.push({
                path: "/device"
            }))
        }
        );
        const M = () => {
            const l = navigator.language.toLowerCase();
            console.log("浏览器语言：", l),
            l.includes("zh") ? c.value = "zh" : c.value = "en"
        }
        ;
        return K( () => {
            M()
        }
        ),
        (l, o) => {
            const P = V
              , h = N;
            return R(),
            F("div", O, [o[5] || (o[5] = s("div", {
                class: "bg-grid"
            }, null, -1)), o[6] || (o[6] = s("div", {
                class: "bg-glow"
            }, null, -1)), s("div", j, [o[3] || (o[3] = s("div", {
                class: "picBox"
            }, [s("div", {
                class: "keyboard-light"
            }), s("div", {
                class: "overlay-pattern"
            })], -1)), s("div", A, [s("div", T, [s("div", {
                class: z(w(d) === "RK" ? "logoBox_rk" : "logoBox_kzzi")
            }, o[2] || (o[2] = [s("div", {
                class: "logo-glow"
            }, null, -1)]), 2), s("h2", q, D(l.$t("messages.connectStr1")), 1), r(H, {
                size: "large",
                color: "primary",
                class: "connectBtn",
                onClick: B
            }, {
                default: f( () => [s("span", W, D(l.$t("messages.connectStr2")), 1)]),
                _: 1
            }), s("div", J, [r(h, {
                type: "segment",
                animated: "",
                value: w(c)
            }, {
                default: f( () => [r(P, {
                    name: "zh",
                    tab: "中文",
                    onClick: o[0] || (o[0] = y => k("zh"))
                }), r(P, {
                    name: "en",
                    tab: "English",
                    onClick: o[1] || (o[1] = y => k("en"))
                })]),
                _: 1
            }, 8, ["value"])])])])]), s("div", Q, [s("span", null, [o[4] || (o[4] = Y("Copyright © 2024 ")), s("span", U, D(w(d)), 1)])])])
        }
    }
}
  , ea = b(X, [["__scopeId", "data-v-bd3e2865"]]);
export {ea as default};
